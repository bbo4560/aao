<Window x:Class="TEST2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TEST2"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="練習" Height="600" Width="1000" WindowStartupLocation="CenterScreen" Background="#F0F2F5">

    <!-- 建議加入資源樣式，解決你之前 XAML 中參照 {StaticResource ActionButtonStyle} 可能找不到的問題 -->
    <Window.Resources>
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="50"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Padding" Value="2"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <!-- 通用的上方功能按鈕樣式 -->
        <Style TargetType="Button">
            <Setter Property="Margin" Value="5,0,0,0"/>
            <Setter Property="Height" Value="30"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 上方功能列 -->
        <Grid Grid.Row="0" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal">
                <Button Content="新增" Click="BtnAdd_Click" Width="80"/>
                <Button Content="查詢" Click="BtnQuery_Click" Width="80"/>

                <!-- 加上 x:Name -->
                <Button x:Name="BtnImport" Content="匯入" Click="BtnImport_Click" Width="80"/>
                <Button x:Name="BtnExport" Content="匯出" Click="BtnExport_Click" Width="80"/>

                <Button Content="查看操作紀錄" Click="BtnLog_Click" Width="140"/>
                <Button x:Name="BtnBatchDelete" Content="批量刪除" Click="BtnBatchDelete_Click" Width="100" Background="#F44336" Foreground="White" Margin="20,0,0,0"/>
                <Button Content="顯示全部" Click="BtnShowAll_Click" Width="100" Background="#607D8B" Foreground="White" Margin="5,0,0,0"/>
            </StackPanel>

            <TextBlock x:Name="txtLastOpTime" Grid.Column="1" Text="最後操作時間: -" VerticalAlignment="Center" Foreground="#888888" FontSize="13"/>
        </Grid>

        <!-- 資料表格 -->
        <DataGrid x:Name="dataGrid" Grid.Row="1" AutoGenerateColumns="False" CanUserSortColumns="True" CanUserReorderColumns="False">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Time" Binding="{Binding Time, StringFormat='yyyy/MM/dd HH:mm:ss'}" SortMemberPath="Time" Width="200"/>
                <DataGridTextColumn Header="PanelID" Binding="{Binding PanelID}" SortMemberPath="PanelID" Width="*"/>
                <DataGridTextColumn Header="LOTID" Binding="{Binding LOTID}" SortMemberPath="LOTID" Width="*"/>
                <DataGridTextColumn Header="CarrierID" Binding="{Binding CarrierID}" SortMemberPath="CarrierID" Width="*"/>

                <DataGridTemplateColumn Header="操作" Width="150">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <!-- 這裡使用了 StaticResource ActionButtonStyle，確保 Window.Resources 裡有定義 -->
                                <Button Content="刪除" Click="BtnDelete_Click" Style="{StaticResource ActionButtonStyle}" Foreground="#FF5252"/>
                                <Button Content="修改" Click="BtnModify_Click" Style="{StaticResource ActionButtonStyle}" Foreground="#333333"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Window>
