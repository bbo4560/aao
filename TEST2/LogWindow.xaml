<Window x:Class="TEST2.LogWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="操作紀錄" Height="600" Width="1100" 
        WindowStartupLocation="CenterOwner" 
        Background="#F0F2F5">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button x:Name="BtnExport"
                        Content="匯出 Excel" 
                        Click="BtnExport_Click"
                        Padding="15,5"
                        Margin="0,0,10,0"
                        Foreground="White"
                        Background="#217346"
                        FontWeight="Bold"
                        BorderThickness="0">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="3"/>
                        </Style>
                    </Button.Resources>
                </Button>

                <Button x:Name="BtnClear"
                        Content="清除所有紀錄" 
                        Click="BtnClear_Click"
                        Padding="15,5"
                        Foreground="White"
                        Background="#FF4D4F"
                        FontWeight="Bold"
                        BorderThickness="0">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="3"/>
                        </Style>
                    </Button.Resources>
                </Button>
            </StackPanel>
        </Grid>

        <DataGrid x:Name="logGrid" Grid.Row="1"
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False" 
                  CanUserReorderColumns="False" 
                  IsReadOnly="True"
                  VerticalScrollBarVisibility="Auto"
                  RowHeight="80">

            <DataGrid.Columns>
                <DataGridTextColumn Header="操作時間" 
                                    Binding="{Binding OperationTime, StringFormat='yyyy/MM/dd HH:mm:ss'}" 
                                    Width="180">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="Margin" Value="5,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="操作電腦名稱" 
                                    Binding="{Binding MachineName}" 
                                    Width="140">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="Margin" Value="5,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="操作類型" 
                                    Binding="{Binding OperationType}" 
                                    Width="90">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="Margin" Value="5,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTemplateColumn Header="被操作資料" Width="300">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding AffectedData}" 
                                       TextWrapping="Wrap" 
                                       VerticalAlignment="Center" 
                                       Margin="5"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Header="詳細描述" Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding DetailDescription}" 
                                       TextWrapping="Wrap" 
                                       VerticalAlignment="Center" 
                                       Margin="5">
                                <TextBlock.ToolTip>
                                    <ToolTip>
                                        <TextBlock Text="{Binding DetailDescription}" 
                                                   TextWrapping="Wrap" 
                                                   MaxWidth="600"/>
                                    </ToolTip>
                                </TextBlock.ToolTip>
                            </TextBlock>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Window>
